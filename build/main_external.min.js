var config,data,product_id,req,script,scriptSrc;script=document.getElementById("we-widget-script"),scriptSrc=script.getAttribute("src"),scriptSrc=scriptSrc.substring(0,scriptSrc.lastIndexOf("/")),product_id=window.wide_eyes_product_id,config=window.wide_eyes_config,data={ProductId:product_id,MinNumResults:config.numberOfElements+1||5},req=new XMLHttpRequest,req.addEventListener("readystatechange",function(){var e,n,t,i;return 4===req.readyState&&200===req.status?(t=JSON.parse(req.responseText),t.result_both.splice(0,2),n=document.createElement("iframe"),n.setAttribute("width","100%"),n.setAttribute("id","we-iframe"),n.setAttribute("seamless",!0),n.setAttribute("frameborder","no"),n.setAttribute("scrolling","no"),n.setAttribute("onload",'iFrameResize({checkOrigin: false}, "#we-iframe")'),i=document.getElementById("widget"),i.appendChild(n),"debug"===config.mode?(t=JSON.stringify(t),config=JSON.stringify(config),e="<!DOCTYPE html> <html> <head> <script> var products = "+t+"; var config = "+config+'; var product_id = "'+product_id+'"; </script> <link rel="stylesheet" href="'+scriptSrc+'/css/main.css"> <base target="_blank"/> </head> <body> <section id="widget"></section> <script src="'+scriptSrc+'/vendor/requirejs/require.js"></script> <script src="'+scriptSrc+'/vendor/iframe-resizer/src/iframeResizer.contentWindow.js"></script> <script src="'+scriptSrc+'/main.js"></script> </body> </html>'):"production"!==config.mode&&config.mode||(t=JSON.stringify(t),config=JSON.stringify(config),e="<!DOCTYPE html> <html> <head> <script> var products = "+t+"; var config = "+config+'; var product_id = "'+product_id+'"; </script> <link rel="stylesheet" href="'+scriptSrc+'/main.min.css"> <base target="_blank"/> </head> <body> <section id="widget"></section> <script src="'+scriptSrc+'/main_internal.min.js"></script> </body> </html>'),n.contentWindow.document.open(),n.contentWindow.document.write(e),n.contentWindow.document.close()):void 0}),req.open("POST","http://api.wide-eyes.it/v1/SearchById",!0),req.setRequestHeader("apikey",config.apikey),req.setRequestHeader("Content-Type","application/json; charset=UTF-8"),req.send(JSON.stringify(data)),function(){"use strict";function e(e,n,t){"addEventListener"in window?e.addEventListener(n,t,!1):"attachEvent"in window&&e.attachEvent("on"+n,t)}function n(){var e,n=["moz","webkit","o","ms"];for(e=0;e<n.length&&!S;e+=1)S=window[n[e]+"RequestAnimationFrame"];S||r(" RequestAnimationFrame not supported")}function t(){var e="Host page";return window.top!==window.self&&(e=window.parentIFrame?window.parentIFrame.getId():"Nested host page"),e}function i(e){return x+"["+t()+"]"+e}function r(e){b&&"object"==typeof window.console&&console.log(i(e))}function o(e){"object"==typeof window.console&&console.warn(i(e))}function a(e){function n(){function e(){u(M),c(),O[q].resizedCallback(M)}a("Height"),a("Width"),l(e,M,"resetPage")}function t(e){var n=e.id;r(" Removing iFrame: "+n),e.parentNode.removeChild(e),O[n].closedCallback(n),delete O[n],r(" --")}function i(){var e=C.substr(I).split(":");return{iframe:document.getElementById(e[0]),id:e[0],height:e[1],width:e[2],type:e[3]}}function a(e){var n=Number(O[q]["max"+e]),t=Number(O[q]["min"+e]),i=e.toLowerCase(),o=Number(M[i]);if(t>n)throw new Error("Value for min"+e+" can not be greater than max"+e);r(" Checking "+i+" is in range "+t+"-"+n),t>o&&(o=t,r(" Set "+i+" to min value")),o>n&&(o=n,r(" Set "+i+" to max value")),M[i]=""+o}function f(){function n(){function e(){r(" Checking connection is from allowed list of origins: "+i);var e;for(e=0;e<i.length;e++)if(i[e]===t)return!0;return!1}function n(){return r(" Checking connection is from: "+o),t===o}return i.constructor===Array?e():n()}var t=e.origin,i=O[q].checkOrigin,o=M.iframe.src.split("/").slice(0,3).join("/");if(i&&""+t!="null"&&!n())throw new Error("Unexpected message received from: "+t+" for "+M.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function m(){return x===(""+C).substr(0,I)}function g(){var e=M.type in{"true":1,"false":1,undefined:1};return e&&r(" Ignoring init message from meta parent page"),e}function p(e){return C.substr(C.indexOf(":")+k+e)}function w(e){r(" MessageCallback passed: {iframe: "+M.iframe.id+", message: "+e+"}"),O[q].messageCallback({iframe:M.iframe,message:JSON.parse(e)}),r(" --")}function h(){return null===M.iframe?(o(" IFrame ("+M.id+") not found"),!1):!0}function y(e){var n=e.getBoundingClientRect();return s(),{x:parseInt(n.left,10)+parseInt(F.x,10),y:parseInt(n.top,10)+parseInt(F.y,10)}}function v(e){function n(){F=a,S(),r(" --")}function t(){return{x:Number(M.width)+i.x,y:Number(M.height)+i.y}}var i=e?y(M.iframe):{x:0,y:0},a=t();r(" Reposition requested from iFrame (offset x:"+i.x+" y:"+i.y+")"),window.top!==window.self?window.parentIFrame?e?window.parentIFrame.scrollToOffset(a.x,a.y):window.parentIFrame.scrollTo(M.width,M.height):o(" Unable to scroll to requested position, window.parentIFrame not found"):n()}function S(){!1!==O[q].scrollCallback(F)&&c()}function E(e){function n(e){var n=y(e);r(" Moving to in page link (#"+t+") at x: "+n.x+" y: "+n.y),F={x:n.x,y:n.y},S(),r(" --")}var t=e.split("#")[1]||"",i=decodeURIComponent(t),o=document.getElementById(i)||document.getElementsByName(i)[0];window.top!==window.self?window.parentIFrame?window.parentIFrame.moveToAnchor(t):r(" In page link #"+t+" not found and window.parentIFrame not found"):o?n(o):r(" In page link #"+t+" not found")}function R(){switch(M.type){case"close":t(M.iframe);break;case"message":w(p(6));break;case"scrollTo":v(!1);break;case"scrollToOffset":v(!0);break;case"inPageLink":E(p(9));break;case"reset":d(M);break;case"init":n(),O[q].initCallback(M.iframe);break;default:n()}}function z(e){var n=!0;return O[e]||(n=!1,o(M.type+" No settings for "+e+". Message was: "+C)),n}var C=e.data,M={},q=null;m()&&(M=i(),q=M.id,!g()&&z(q)&&(b=O[q].log,r(" Received: "+C),h()&&f()&&(O[q].firstRun=!1,R())))}function s(){null===F&&(F={x:void 0!==window.pageXOffset?window.pageXOffset:document.documentElement.scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:document.documentElement.scrollTop},r(" Get page position: "+F.x+","+F.y))}function c(){null!==F&&(window.scrollTo(F.x,F.y),r(" Set page position: "+F.x+","+F.y),F=null)}function d(e){function n(){u(e),f("reset","reset",e.iframe,e.id)}r(" Size reset requested by "+("init"===e.type?"host page":"iFrame")),s(),l(n,e,"init")}function u(e){function n(n){e.iframe.style[n]=e[n]+"px",r(" IFrame ("+t+") "+n+" set to "+e[n]+"px")}var t=e.iframe.id;O[t].sizeHeight&&n("height"),O[t].sizeWidth&&n("width")}function l(e,n,t){t!==n.type&&S?(r(" Requesting animation frame"),S(e)):e()}function f(e,n,t,i){t&&t.contentWindow?(r("["+e+"] Sending msg to iframe ("+n+")"),t.contentWindow.postMessage(x+n,"*")):(o("["+e+"] IFrame not found"),O[i]&&delete O[i])}function m(n){function t(){function e(e){1/0!==O[g][e]&&0!==O[g][e]&&(m.style[e]=O[g][e]+"px",r(" Set "+e+" = "+O[g][e]+"px"))}e("maxHeight"),e("minHeight"),e("maxWidth"),e("minWidth")}function i(e){return""===e&&(m.id=e="iFrameResizer"+y++,b=(n||{}).log,r(" Added missing iframe ID: "+e+" ("+m.src+")")),e}function o(){r(" IFrame scrolling "+(O[g].scrolling?"enabled":"disabled")+" for "+g),m.style.overflow=!1===O[g].scrolling?"hidden":"auto",m.scrolling=!1===O[g].scrolling?"no":"yes"}function a(){("number"==typeof O[g].bodyMargin||"0"===O[g].bodyMargin)&&(O[g].bodyMarginV1=O[g].bodyMargin,O[g].bodyMargin=""+O[g].bodyMargin+"px")}function s(){return g+":"+O[g].bodyMarginV1+":"+O[g].sizeWidth+":"+O[g].log+":"+O[g].interval+":"+O[g].enablePublicMethods+":"+O[g].autoResize+":"+O[g].bodyMargin+":"+O[g].heightCalculationMethod+":"+O[g].bodyBackground+":"+O[g].bodyPadding+":"+O[g].tolerance+":"+O[g].enableInPageLinks+":"+O[g].resizeFrom}function c(n){e(m,"load",function(){var e=O[g].firstRun;f("iFrame.onload",n,m),!e&&O[g].heightCalculationMethod in E&&d({iframe:m,height:0,width:0,type:"init"})}),f("init",n,m)}function u(e){if("object"!=typeof e)throw new TypeError("Options is not an object.")}function l(e){e=e||{},O[g]={firstRun:!0},u(e);for(var n in z)z.hasOwnProperty(n)&&(O[g][n]=e.hasOwnProperty(n)?e[n]:z[n]);b=O[g].log}var m=this,g=i(m.id);l(n),o(),t(),a(),c(s())}function g(e,n){null===R&&(R=setTimeout(function(){R=null,e()},n))}function p(){function e(e){return"parent"===O[e].resizeFrom&&O[e].autoResize&&!O[e].firstRun}g(function(){for(var n in O)e(n)&&f("Window resize","resize",document.getElementById(n),n)},66)}function w(){function t(e,n){if(!e.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==e.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+e.tagName+">.");m.call(e,n)}return n(),e(window,"message",a),e(window,"resize",p),function(e,n){switch(typeof n){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(n||"iframe"),function(n){t(n,e)});break;case"object":t(n,e);break;default:throw new TypeError("Unexpected data type ("+typeof n+").")}}}function h(e){e.fn.iFrameResize=function(e){return this.filter("iframe").each(function(n,t){m.call(t,e)}).end()}}var y=0,b=!1,v="message",k=v.length,x="[iFrameSizer]",I=x.length,F=null,S=window.requestAnimationFrame,E={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},O={},R=null,z={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,enableInPageLinks:!1,enablePublicMethods:!1,heightCalculationMethod:"offset",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,closedCallback:function(){},initCallback:function(){},messageCallback:function(){},resizedCallback:function(){},scrollCallback:function(){return!0}};window.jQuery&&h(jQuery),"function"==typeof define&&define.amd?define([],w):"object"==typeof module&&"object"==typeof module.exports?module.exports=w():window.iFrameResize=window.iFrameResize||w()}();